---
title: 'Amusement Park Injuries - #TidyTuesday'
author: Evan Canfield
date: '2019-09-10'
slug: Amusement Park injuries
categories:
  - '#TidyTuesday'
tags:
  - ggplot2
description: When Danger Strikes!
---



<p>For #tidytuesday we’re looking at Amusement Park injuries. I plan on making a simple visual of the number of injuries by month.</p>
<div id="libraries" class="section level1">
<h1>Libraries</h1>
<pre class="r"><code>if (!require(pacman)) {install.packages(&#39;pacman&#39;)} 
p_load(
    janitor
  , skimr
  , stringr
  , tidyverse
  , lubridate
  )</code></pre>
</div>
<div id="import-data" class="section level1">
<h1>Import Data</h1>
<p>Previous inspection of the raw data shows that some NA values are denoted other strings such as “n/a” or “#########”. This does not get picked up as NA in the default condition so must me manually listed.</p>
<pre class="r"><code>tx_injuries &lt;- readr::read_csv(&quot;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-09-10/tx_injuries.csv&quot;
                                 , na = c(&quot;NA&quot;, &quot;n/a&quot;, &quot;#########&quot;, &quot;N/A&quot;, &quot;na&quot;))</code></pre>
</div>
<div id="data-cleaning-preparation" class="section level1">
<h1>Data Cleaning / Preparation</h1>
<div id="date-correction" class="section level2">
<h2>Date Correction</h2>
<p>There are two date formats used in the data set. One date has a “M/D/Y” format. The other date is represented as a serial number. Both are character strings. To covert the dates to a consistent format and a date object the following steps were taken.</p>
<ol style="list-style-type: decimal">
<li>Drop all missing dates.</li>
<li>Use an if/else statement to determine which date format is being processed.</li>
<li>For the “M/D/Y” dates use the mdy() function from <strong>lubridate</strong> to convert to a date object. Save the date object in a new column using mutate.</li>
<li>Convert the serial date values into a character string date with a “M-D-Y” format. Then use the <em>excel_numeric_to_date</em> from the <strong>janitor</strong> package to convert to a date object. Save the date object in a new column using mutate, the same column as the other date format from Step 3.</li>
</ol>
<pre class="r"><code># Consolidate Date Types / Drop Missing Dates

tx_injuries &lt;- tx_injuries %&gt;%
  drop_na(injury_date) %&gt;%                          # Drop N/A Injury Dates
  mutate(injury_date_conv = if_else(                # Unify Date Type
    grepl(pattern = &quot;/&quot;,x = injury_date),           # Check if date has the character &quot;/&quot;                         
    mdy(injury_date),                               # Converts M-D-Y type dates
    excel_numeric_to_date(as.numeric(injury_date)   # Converts Serial type dates
                          , date_system = &quot;modern&quot;)
  )
  )</code></pre>
</div>
<div id="injuries-by-month" class="section level2">
<h2>Injuries By Month</h2>
<p>With a new column with each injury date as a date object, we then sum the number of injuries each month, using <em>group_by</em> with both year and month. For the final visual a dummy day column is added, with date of 1. This day column will be used to create another date object. To create the date object a string is generated by concatenating the year, month, and day columns into a new single column, and then converting this full date string into a date object again using the mdy() function from <strong>lubridate</strong>.</p>
<pre class="r"><code># Data Frame Development
tx_injuries &lt;- tx_injuries %&gt;% 
  mutate(month = month(injury_date_conv),
         year = year(injury_date_conv)) %&gt;% 
  group_by(year, month) %&gt;% 
  summarise(injuries = n()) %&gt;% 
  mutate(day = 1,
         eff_date_char = paste(year,month,day, sep = &quot;-&quot;),
         eff_date = ymd(eff_date_char)) %&gt;% 
  select(-eff_date_char)</code></pre>
</div>
</div>
<div id="visual" class="section level1">
<h1>Visual</h1>
<p>Now the injuries recorded each month can be plotted. Clear seasonal activity, which probably tracks against total visists.</p>
<pre class="r"><code>#Visual
ggplot(data = tx_injuries
       , mapping = aes( x = eff_date, y = injuries)) +
  geom_col(fill = &quot;#1F618D&quot;, alpha = 0.75) +
  scale_x_date(
    date_labels = &quot;%Y&quot;,
    breaks = &quot;1 year&quot;) +
  labs(title = &quot;Number of Injuries at Amusement Parks, By Month&quot;
       , caption = &quot;Data by Data.world | #TidyTuesday&quot;) +
  ylab(&quot;Injuries&quot;) +
  xlab(&quot;Year&quot;) +
  theme_minimal() +
  theme(axis.text.x =  element_text(hjust=-1.6))</code></pre>
<p><img src="/post/2019-09-10-tidy-tuesday-week-37/2019-09-10-amusement-park-injuries-tidytuesday_files/figure-html/visual-1.png" width="672" /></p>
</div>
